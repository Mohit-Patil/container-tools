version: '3.8'

services:
  ai-tools:
    build:
      context: .
      dockerfile: Dockerfile
    image: ai-cli-tools:latest
    container_name: ai-cli-tools

    # Interactive TTY for CLI tools
    stdin_open: true
    tty: true

    # Volumes
    volumes:
      # Mount current directory as workspace
      - .:/workspace
      # Named volumes for persistent auth (different tools use different locations)
      - ai-cli-config:/home/devuser/.config
      - ai-cli-claude:/home/devuser/.claude
      - ai-cli-codex:/home/devuser/.codex
      - ai-cli-aider:/home/devuser/.aider
      # Optional: Mount git config from host (uncomment if needed)
      # - ~/.gitconfig:/home/devuser/.gitconfig:ro
      # Optional: Mount SSH keys (uncomment if needed)
      # - ~/.ssh:/home/devuser/.ssh:ro

    # Environment variables
    environment:
      - TERM=xterm-256color
      - HOST_PWD=${PWD}
      - CLAUDE_CONFIG_DIR=/home/devuser/.claude

    # Load environment from file (if exists)
    env_file:
      - path: .env
        required: false

    # Working directory
    working_dir: /workspace

    # Default command
    command: /bin/bash

volumes:
  ai-cli-config:
    name: ai-cli-config
  ai-cli-claude:
    name: ai-cli-claude
  ai-cli-codex:
    name: ai-cli-codex
  ai-cli-aider:
    name: ai-cli-aider
